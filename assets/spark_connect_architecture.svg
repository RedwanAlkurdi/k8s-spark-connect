<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Modern gradient definitions -->
  <defs>
    <!-- Background gradient -->
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f0f23;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1a1a2e;stop-opacity:1" />
    </linearGradient>
    
    <!-- Kubernetes cluster gradient -->
    <linearGradient id="k8sGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#16213e;stop-opacity:0.9" />
      <stop offset="100%" style="stop-color:#0f3460;stop-opacity:0.9" />
    </linearGradient>
    
    <!-- Component gradients -->
    <linearGradient id="sparkGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ee5a52;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="nginxGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4ecdc4;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#44a08d;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="clientGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="externalGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ffecd2;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#fcb69f;stop-opacity:1" />
    </linearGradient>
    
    <!-- Glow effects -->
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge> 
        <feMergeNode in="coloredBlur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    
    <!-- Drop shadow -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="4" dy="4" stdDeviation="4" flood-color="#000000" flood-opacity="0.3"/>
    </filter>
    
    <!-- Arrow marker -->
    <marker id="arrowhead" markerWidth="12" markerHeight="8" refX="11" refY="4" orient="auto">
      <polygon points="0 0, 12 4, 0 8" fill="#64ffda" filter="url(#glow)"/>
    </marker>
    
    <marker id="arrowheadOptional" markerWidth="12" markerHeight="8" refX="11" refY="4" orient="auto">
      <polygon points="0 0, 12 4, 0 8" fill="#bb86fc" opacity="0.7"/>
    </marker>
  </defs>
  
  <!-- Modern dark background -->
  <rect width="1200" height="800" fill="url(#bgGradient)"/>
  
  <!-- Subtle grid pattern -->
  <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
    <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#ffffff" stroke-width="0.5" opacity="0.1"/>
  </pattern>
  <rect width="1200" height="800" fill="url(#grid)"/>
  
  <!-- Modern title with glow effect -->
  <text x="600" y="40" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="28" font-weight="300" fill="#ffffff" filter="url(#glow)">
    Spark Connect Helm Chart Architecture
  </text>
  
  <!-- Kubernetes Cluster Container with modern glassmorphism style -->
  <rect x="80" y="80" width="1040" height="520" rx="20" fill="url(#k8sGradient)" 
        stroke="#64ffda" stroke-width="2" filter="url(#shadow)" opacity="0.95"/>
  <rect x="80" y="80" width="1040" height="520" rx="20" fill="none" 
        stroke="url(#k8sGradient)" stroke-width="1" opacity="0.3"/>
  <text x="110" y="110" font-family="'Segoe UI', Arial, sans-serif" font-size="18" font-weight="400" fill="#64ffda">
    Kubernetes Cluster
  </text>
  
  <!-- External Management Components -->
  <g id="external-components">
    <!-- External DNS -->
    <rect x="120" y="140" width="140" height="70" rx="15" fill="url(#externalGradient)" 
          stroke="#fcb69f" stroke-width="2" filter="url(#shadow)"/>
    <text x="190" y="165" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="600" fill="#2c3e50">External DNS</text>
    <text x="190" y="185" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#2c3e50">DNS Management</text>
    <text x="190" y="200" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#2c3e50">& Routing</text>
    
    <!-- Cert Manager -->
    <rect x="280" y="140" width="140" height="70" rx="15" fill="url(#externalGradient)" 
          stroke="#fcb69f" stroke-width="2" filter="url(#shadow)"/>
    <text x="350" y="165" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="600" fill="#2c3e50">Cert Manager</text>
    <text x="350" y="185" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#2c3e50">TLS Certificate</text>
    <text x="350" y="200" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#2c3e50">Provisioning</text>
    
    <!-- Trust Manager -->
    <rect x="440" y="140" width="140" height="70" rx="15" fill="url(#externalGradient)" 
          stroke="#fcb69f" stroke-width="2" filter="url(#shadow)"/>
    <text x="510" y="165" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="600" fill="#2c3e50">Trust Manager</text>
    <text x="510" y="185" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#2c3e50">Certificate</text>
    <text x="510" y="200" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#2c3e50">Trust Chain</text>
  </g>
  
  <!-- NGINX Service (Optional) with modern card design -->
  <g id="nginx-service">
    <rect x="120" y="250" width="260" height="120" rx="20" fill="url(#nginxGradient)" 
          stroke="#4ecdc4" stroke-width="2" stroke-dasharray="8,4" filter="url(#shadow)" opacity="0.9"/>
    <text x="250" y="275" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="16" font-weight="600" fill="#ffffff">
      NGINX Service
    </text>
    <text x="250" y="295" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#ffffff" opacity="0.8">
      (Optional)
    </text>
    
    <g fill="#ffffff" opacity="0.9">
      <circle cx="140" cy="315" r="3"/>
      <text x="155" y="320" font-family="'Segoe UI', Arial, sans-serif" font-size="12">SSL/TLS Termination</text>
      <circle cx="140" cy="335" r="3"/>
      <text x="155" y="340" font-family="'Segoe UI', Arial, sans-serif" font-size="12">Traffic Routing</text>
      <circle cx="140" cy="355" r="3"/>
      <text x="155" y="360" font-family="'Segoe UI', Arial, sans-serif" font-size="12">GRPC âžœ Spark Connect</text>
    </g>
  </g>
  
  <!-- Spark Connect Core with modern design -->
  <g id="spark-connect">
    <rect x="420" y="250" width="300" height="150" rx="20" fill="url(#sparkGradient)" 
          stroke="#ff6b6b" stroke-width="3" filter="url(#shadow)"/>
    <text x="570" y="280" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="18" font-weight="600" fill="#ffffff">
      Spark Connect Service
    </text>
    
    <g fill="#ffffff" opacity="0.9">
      <circle cx="440" cy="305" r="3"/>
      <text x="455" y="310" font-family="'Segoe UI', Arial, sans-serif" font-size="12">Spark Connect Server</text>
      <circle cx="440" cy="325" r="3"/>
      <text x="455" y="330" font-family="'Segoe UI', Arial, sans-serif" font-size="12">Auto-scaling via K8s</text>
      <circle cx="440" cy="345" r="3"/>
      <text x="455" y="350" font-family="'Segoe UI', Arial, sans-serif" font-size="12">Spark UI Dashboard</text>
      <circle cx="440" cy="365" r="3"/>
      <text x="455" y="370" font-family="'Segoe UI', Arial, sans-serif" font-size="12">Cluster Management</text>
    </g>
    
    <!-- Modern pod representation -->
    <g id="pods">
      <rect x="450" y="375" width="60" height="20" rx="10" fill="#ffffff" opacity="0.2"/>
      <text x="480" y="388" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="9" fill="#ffffff">Pod 1</text>
      <rect x="520" y="375" width="60" height="20" rx="10" fill="#ffffff" opacity="0.2"/>
      <text x="550" y="388" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="9" fill="#ffffff">Pod 2</text>
      <rect x="590" y="375" width="60" height="20" rx="10" fill="#ffffff" opacity="0.2"/>
      <text x="620" y="388" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="9" fill="#ffffff">Pod N</text>
    </g>
  </g>
  
  <!-- Optional External Services with modern cards -->
  <g id="optional-services">
    <!-- Object Storage -->
    <rect x="780" y="250" width="160" height="90" rx="15" fill="#16a085" 
          stroke="#1abc9c" stroke-width="2" stroke-dasharray="8,4" filter="url(#shadow)" opacity="0.9"/>
    <text x="860" y="275" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="600" fill="#ffffff">Object Storage</text>
    <text x="860" y="295" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#ffffff" opacity="0.8">(Optional)</text>
    <text x="860" y="315" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#ffffff">SSL Integration</text>
    <text x="860" y="330" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#ffffff">Trust Configuration</text>
    
    <!-- Celeborn -->
    <rect x="780" y="360" width="160" height="90" rx="15" fill="#8e44ad" 
          stroke="#9b59b6" stroke-width="2" stroke-dasharray="8,4" filter="url(#shadow)" opacity="0.9"/>
    <text x="860" y="385" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="600" fill="#ffffff">Celeborn</text>
    <text x="860" y="405" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#ffffff" opacity="0.8">(Optional)</text>
    <text x="860" y="425" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#ffffff">External Shuffle</text>
    <text x="860" y="440" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#ffffff">Service</text>
    
    <!-- Hive Metastore -->
    <rect x="780" y="470" width="160" height="90" rx="15" fill="#d35400" 
          stroke="#e67e22" stroke-width="2" stroke-dasharray="8,4" filter="url(#shadow)" opacity="0.9"/>
    <text x="860" y="495" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="14" font-weight="600" fill="#ffffff">Hive Metastore</text>
    <text x="860" y="515" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#ffffff" opacity="0.8">(Optional)</text>
    <text x="860" y="535" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#ffffff">Metadata</text>
    <text x="860" y="550" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#ffffff">Management</text>
  </g>
  
  <!-- External Development Environment (Outside Kubernetes) -->
  <g id="external-client">
    <rect x="200" y="650" width="280" height="100" rx="20" fill="url(#clientGradient)" 
          stroke="#667eea" stroke-width="3" filter="url(#shadow)"/>
    <text x="340" y="680" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="16" font-weight="600" fill="#ffffff">
      Development Environment
    </text>
    <text x="340" y="700" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#ffffff" opacity="0.8">
      (Your Local Machine)
    </text>
    
    <g fill="#ffffff" opacity="0.9">
      <circle cx="220" cy="720" r="3"/>
      <text x="235" y="725" font-family="'Segoe UI', Arial, sans-serif" font-size="12">IDE (IntelliJ, VSCode)</text>
      <circle cx="220" cy="735" r="3"/>
      <text x="235" y="740" font-family="'Segoe UI', Arial, sans-serif" font-size="12">Jupyter Notebook</text>
    </g>
  </g>
  
  <!-- Modern Connection Lines -->
  <!-- External Client to NGINX (crosses cluster boundary) -->
  <path d="M 340 650 L 250 370" stroke="#64ffda" stroke-width="3" marker-end="url(#arrowhead)" fill="none" filter="url(#glow)"/>
  <text x="280" y="510" font-family="'Segoe UI', Arial, sans-serif" font-size="11" fill="#64ffda" transform="rotate(-70, 280, 510)">
    GRPC/HTTPS
  </text>
  
  <!-- NGINX to Spark Connect -->
  <path d="M 380 310 L 420 325" stroke="#64ffda" stroke-width="3" marker-end="url(#arrowhead)" fill="none" filter="url(#glow)"/>
  
  <!-- Spark Connect to Optional Services -->
  <path d="M 720 320 L 780 295" stroke="#bb86fc" stroke-width="2" marker-end="url(#arrowheadOptional)" fill="none" stroke-dasharray="8,4"/>
  <path d="M 720 340 L 780 405" stroke="#bb86fc" stroke-width="2" marker-end="url(#arrowheadOptional)" fill="none" stroke-dasharray="8,4"/>
  <path d="M 720 360 L 780 515" stroke="#bb86fc" stroke-width="2" marker-end="url(#arrowheadOptional)" fill="none" stroke-dasharray="8,4"/>
  
  <!-- External services to components -->
  <path d="M 190 210 L 200 250" stroke="#fcb69f" stroke-width="2" marker-end="url(#arrowhead)" fill="none"/>
  <path d="M 350 210 L 320 250" stroke="#fcb69f" stroke-width="2" marker-end="url(#arrowhead)" fill="none"/>
  <!-- Trust Manager to Spark Connect -->
  <path d="M 510 210 L 570 250" stroke="#fcb69f" stroke-width="2" marker-end="url(#arrowhead)" fill="none"/>
  
  <!-- Modern Legend with glassmorphism -->
  <g id="legend">
    <rect x="600" y="650" width="280" height="130" rx="20" fill="#ffffff" opacity="0.1" 
          stroke="#64ffda" stroke-width="1" filter="url(#shadow)"/>
    <rect x="600" y="650" width="280" height="130" rx="20" fill="none" 
          stroke="#ffffff" stroke-width="1" opacity="0.2"/>
    <text x="740" y="675" text-anchor="middle" font-family="'Segoe UI', Arial, sans-serif" font-size="16" font-weight="600" fill="#ffffff">
      Legend
    </text>
    
    <line x1="620" y1="695" x2="650" y2="695" stroke="#64ffda" stroke-width="3" filter="url(#glow)"/>
    <text x="660" y="700" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#ffffff">Required Connection</text>
    
    <line x1="620" y1="715" x2="650" y2="715" stroke="#bb86fc" stroke-width="2" stroke-dasharray="8,4"/>
    <text x="660" y="720" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#ffffff">Optional Connection</text>
    
    <rect x="620" y="730" width="20" height="15" rx="3" fill="none" stroke="#ffffff" stroke-width="2" stroke-dasharray="8,4"/>
    <text x="660" y="742" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#ffffff">Optional Component</text>
    
    <rect x="620" y="750" width="20" height="15" rx="3" fill="#ff6b6b" stroke="#ff6b6b" stroke-width="2"/>
    <text x="660" y="762" font-family="'Segoe UI', Arial, sans-serif" font-size="12" fill="#ffffff">Core Component</text>
  </g>
</svg>